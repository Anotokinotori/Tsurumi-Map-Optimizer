<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鶴観調整プランナー（周期ホールド対応）</title>
    <!-- CSSファイルを外部から読み込み -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header class="site-header backdrop-blur">
        <div class="header-title-container">
            <h1>
                <span class="title-long">鶴観調整プランナー（周期ホールド対応）</span>
                <span class="title-short">鶴観調整プランナー</span>
            </h1>
        </div>
        <div class="header-info">
            <span class="header-version">Ver. 1.2.2</span>
            <span class="credit-separator">|</span>
            <!-- 製作者リンクをボタンに変更 -->
            <button id="logic-modal-trigger" class="header-link-btn">製作者: あの時の鳥です</button>
        </div>
    </header>

    <div id="info-banner" class="info-banner">
        <p>鶴観の精鋭の仕組みについて詳しく知りたい方は、<a href="https://youtu.be/2xqllaCTP5c?si=m9yyxXo5GS0rwFG9" target="_blank" rel="noopener noreferrer">こちらの解説動画</a>をご覧ください。</p>
        <button id="close-banner-btn" class="close-banner-btn" title="閉じる">&times;</button>
    </div>

    <main>
        <div class="container backdrop-blur">

            <!-- Page 1: Start Screen -->
            <div id="start-page" class="page active">
                <div class="page-content-wrapper">
                    <div class="start-header">
                        <div class="start-title-container">
                             <h1>鶴観調整プランナー</h1>
                             <button id="tsurumi-info-btn" class="info-btn" title="鶴観調整とは？">？</button>
                        </div>
                        <p class="subtitle">現在と理想の配置を入力すると、最短調整スケジュールを計算します</p>
                    </div>
                    
                    <div class="steps-container">
                        <div class="step" data-step="1"> <div class="step-icon">①</div> <div class="step-label">現在の配置を入力</div> </div>
                        <div class="step-arrow">→</div>
                        <div class="step" data-step="2"> <div class="step-icon">②</div> <div class="step-label">理想の配置を入力</div> </div>
                        <div class="step-arrow">→</div>
                        <div class="step" data-step="3"> <div class="step-icon">③</div> <div class="step-label">調整スケジュール</div> </div>
                    </div>

                    <div class="start-buttons">
                        <button id="go-to-current-btn" class="btn btn-primary">調整を始める</button>
                        <button id="load-plan-btn" class="btn btn-secondary">保存したプランを読み込む</button>
                    </div>

                    <div class="start-footer">
                        <div class="multi-mode-toggle">
                            <input type="checkbox" id="boat-mode-checkbox">
                            <label for="boat-mode-checkbox">ボートでの配置調整を許可</label>
                        </div>
                        <div class="multi-mode-toggle">
                            <input type="checkbox" id="multiplayer-mode-checkbox">
                            <label for="multiplayer-mode-checkbox">周期ホールドを有効化</label>
                            <button id="cycle-hold-info-btn" class="help-icon" title="周期ホールドとは？">?</button>
                        </div>
                         <div class="footer-links">
                             <button id="guide-btn" class="btn btn-secondary-link">使い方ガイド</button>
                             <span class="link-separator">|</span>
                             <button id="disclaimer-link" class="btn btn-secondary-link">注意事項</button>
                         </div>
                    </div>
                </div>
            </div>

            <!-- Page 2: Current Configuration Input -->
            <div id="current-config-page" class="page">
                <div class="page-content-wrapper">
                    <div class="page-header">
                        <button id="back-to-start-btn" class="btn-back" aria-label="戻る"></button>
                        <div class="steps-container">
                            <div class="step" data-step="1"> <div class="step-icon">①</div> <div class="step-label">現在の配置を入力</div> </div>
                            <div class="step-arrow">→</div>
                            <div class="step" data-step="2"> <div class="step-icon">②</div> <div class="step-label">理想の配置を入力</div> </div>
                            <div class="step-arrow">→</div>
                            <div class="step" data-step="3"> <div class="step-icon">③</div> <div class="step-label">調整スケジュール</div> </div>
                        </div>
                        <div class="header-placeholder"></div>
                    </div>

                    <div class="view-switcher">
                        <button id="current-map-tab" class="view-tab active" data-view="map">マップ表示</button>
                        <button id="current-list-tab" class="view-tab" data-view="list">リスト表示</button>
                    </div>

                    <div class="input-views-container">
                        <div id="current-map-view" class="input-view active">
                            <div class="map-container" id="current-map-container">
                                 <div class="map-guide-text">アイコンをタップして選択</div>
                                 <img src="https://github.com/Anotokinotori/Tsurumi-Route-Optimizer/blob/main/input_page_map.png?raw=true" alt="鶴観マップ" class="map-bg">
                            </div>
                        </div>
                        <div id="current-list-view" class="input-view">
                            <div class="config-list" id="current-config-list">
                            </div>
                        </div>
                    </div>
                    
                    <div class="page-footer">
                        <div class="left-action">
                            <div class="quick-fill-buttons show-flex-on-desktop">
                                <span class="quick-fill-label">一括入力:</span>
                                <button id="fill-all-a-btn" class="btn btn-secondary btn-small">A</button>
                                <button id="fill-all-b-btn" class="btn btn-secondary btn-small">B</button>
                                <button id="fill-all-c-btn" class="btn btn-secondary btn-small">C</button>
                            </div>
                        </div>
                        <div class="center-action">
                            <div class="progress-text" id="progress-text">入力完了: 0 / 10</div>
                        </div>
                        <div class="right-action">
                            <div id="validation-message" class="validation-message"></div>
                            <button id="go-to-ideal-btn" class="btn btn-primary" disabled>理想の配置へ</button>
                        </div>
                   </div>
                </div>
            </div>
            
            <!-- Page 3: Ideal Configuration Input -->
            <div id="ideal-config-page" class="page">
                <div class="page-content-wrapper">
                     <div class="page-header">
                        <button id="back-to-current-btn" class="btn-back" aria-label="戻る"></button>
                        <div class="steps-container">
                            <div class="step" data-step="1"> <div class="step-icon">①</div> <div class="step-label">現在の配置を入力</div> </div>
                            <div class="step-arrow">→</div>
                            <div class="step" data-step="2"> <div class="step-icon">②</div> <div class="step-label">理想の配置を入力</div> </div>
                            <div class="step-arrow">→</div>
                            <div class="step" data-step="3"> <div class="step-icon">③</div> <div class="step-label">調整スケジュール</div> </div>
                        </div>
                        <div class="header-placeholder"></div>
                    </div>

                    <div class="view-switcher">
                        <button id="ideal-map-tab" class="view-tab active" data-view="map">マップ表示</button>
                        <button id="ideal-list-tab" class="view-tab" data-view="list">リスト表示</button>
                    </div>

                    <div class="input-views-container">
                        <div id="ideal-map-view" class="input-view active">
                            <div class="map-container" id="ideal-map-container">
                                 <div class="map-guide-text">アイコンをタップして選択</div>
                                 <img src="https://github.com/Anotokinotori/Tsurumi-Route-Optimizer/blob/main/input_page_map.png?raw=true" alt="鶴観マップ" class="map-bg">
                            </div>
                        </div>
                        <div id="ideal-list-view" class="input-view">
                            <div class="config-list" id="ideal-config-list">
                            </div>
                        </div>
                    </div>

                     <div class="page-footer">
                        <div class="left-action">
                             <button class="btn btn-secondary" id="set-recommended-btn">環境配置</button>
                             <button class="btn btn-secondary show-on-desktop" id="copy-current-btn">現在配置をコピー</button>
                        </div>
                        <div class="center-action">
                            <div class="progress-text" id="ideal-progress-text">入力完了: 0 / 10</div>
                        </div>
                        <div class="right-action">
                            <button id="calculate-plan-btn" class="btn btn-primary">調整プランを計算</button>
                        </div>
                   </div>
                </div>
            </div>

            <!-- Page 4: Result Page -->
            <div id="result-page" class="page">
                <div class="page-content-wrapper">
                     <div class="page-header">
                        <button id="back-to-ideal-btn" class="btn-back" aria-label="戻る"></button>
                         <div class="steps-container">
                            <div class="step" data-step="1"> <div class="step-icon">①</div> <div class="step-label">現在の配置を入力</div> </div>
                            <div class="step-arrow">→</div>
                            <div class="step" data-step="2"> <div class="step-icon">②</div> <div class="step-label">理想の配置を入力</div> </div>
                            <div class="step-arrow">→</div>
                            <div class="step" data-step="3"> <div class="step-icon">③</div> <div class="step-label">調整スケジュール</div> </div>
                        </div>
                        <div class="header-placeholder"></div>
                    </div>

                    <div class="result-grid">
                        <div class="result-layout-container">
                            <div class="result-map-container">
                                <img src="https://github.com/Anotokinotori/Tsurumi-Route-Optimizer/blob/main/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202025-09-21%20161308.png?raw=true" alt="鶴観マップ 結果表示" class="map-bg">
                            </div>
                            <div class="result-actions-container">
                                <div id="solo-mode-notice" class="solo-notice show-on-desktop">
周期ホールドを使わない調整方法です。使用すると期間をもっと短縮できるかもしれません。<a href="https://youtu.be/2xqllaCTP5c?si=UyMkRCct-Z1Pp5HI&t=1194" target="_blank" rel="noopener noreferrer">詳しくは動画で</a>
                                </div>
                                <button id="recalculate-alternate-mode-btn" class="btn">
                                    <span class="btn-icon icon-recalc"></span>
                                    <span id="recalculate-btn-text"></span>
                                </button>
                                <button id="save-plan-btn" class="btn btn-secondary">
                                    <span class="btn-icon icon-save"></span>
                                    <span>結果を保存</span>
                                </button>
                                <button id="reset-btn" class="btn btn-secondary">
                                    <span class="btn-icon icon-reset"></span>
                                    <span>リセット</span>
                                </button>
                                <button id="disclaimer-link-result-mobile" class="btn btn-secondary-link">注意事項</button>
                            </div>
                        </div>

                        <div id="result-details" class="result-details-container">
                             <div id="result-summary">
                                 <button id="save-plan-icon-btn" class="save-icon-btn" title="結果を保存"></button>
                                 <span id="result-summary-text"></span>
                             </div>
                             <div class="result-table-container">
                                 <table class="result-table">
                                     <thead>
                                         <tr> <th>日付</th> <th>モード</th> <th>2P(ホールド役)の行動</th> <th>1P(ホスト)の行動</th> <th>詳細</th> </tr>
                                     </thead>
                                     <tbody id="result-tbody"></tbody>
                                 </table>
                             </div>
                             <p class="result-footer-link">
                                鶴観のロード範囲（移動ルート）について詳しく知りたい方は<a href="https://note.com/nekoshita_g/n/n485ff9b3df29" target="_blank" rel="noopener noreferrer">こちら</a>
                             </p>
                             <p class="result-disclaimer-desktop">
                                <button id="disclaimer-link-result-pc" class="btn btn-secondary-link">注意事項</button>
                             </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- Modals -->
    <div id="guide-modal" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="guide-modal">&times;</span>
            <h2>使い方ガイド</h2>
            <p>このプランナーは、鶴観の精鋭エネミーの配置を、最短日数で理想の配置に調整するためのスケジュールを計算します。</p>
            
            <hr>

            <h3>Step 1: 現在の配置を入力</h3>
            <p>まず、あなたの世界の現在のエネミー配置を10ヶ所すべて入力します。「マップ表示」または「リスト表示」で入力できます。</p>
            <img src="https://github.com/Anotokinotori/Tsurumi-Route-Optimizer/blob/main/%E4%BD%BF%E3%81%84%E6%96%B9%E3%82%AC%E3%82%A4%E3%83%89GIF/%E7%8F%BE%E5%9C%A8.gif?raw=true" alt="マップ入力画面" style="width:100%; border-radius: 8px; margin-top: 10px;">
            <p style="margin-top: 10px;">マップ上のアイコンをタップすると、詳細なマップが表示され、A/B/Cのパターンを選択できます。選択に迷ったら、スクリーンショットで実際のゲーム画面を確認できます。</p>
            
            <hr>

            <h3>Step 2: 理想の配置を入力</h3>
            <p>次に、目標とする理想の配置を入力します。すべて入力する必要はなく、変更したい場所だけ入力すればOKです。</p>
            <p>便利な「環境配置を自動入力」ボタンも活用してください。</p>
            <img src="https://github.com/Anotokinotori/Tsurumi-Route-Optimizer/blob/main/%E4%BD%BF%E3%81%84%E6%96%B9%E3%82%AC%E3%82%A4%E3%83%89GIF/%E7%90%86%E6%83%B3.gif?raw=true" alt="理想配置の入力" style="width:100%; border-radius: 8px; margin-top: 10px;">
            
            <hr>
            
            <h3>Step 3: スケジュールを計算・確認</h3>
            <p>入力が終わったら、「調整プランを計算」ボタンを押します。</p>
            <p>スタートページで「周期ホールドを有効にする」にチェックを入れていると、マルチプレイを前提とした最短ルートを計算します。</p>
            <img src="https://github.com/Anotokinotori/Tsurumi-Route-Optimizer/blob/main/%E4%BD%BF%E3%81%84%E6%96%B9%E3%82%AC%E3%82%A4%E3%83%89GIF/%E7%B5%90%E6%9E%9C.gif?raw=true" alt="結果表示画面" style="width:100%; border-radius: 8px; margin-top: 10px;">

            <hr>

            <h3>ご注意</h3>
            <p style="text-align: left; line-height: 1.7; font-size: 0.9em;">
                このサイトは、私が個人的に制作した非公式のファンツールです。計算結果の正確性には万全を期していますが、ゲームのアップデートなどにより、情報が古くなったり、予期せぬ不具合が発生したりする可能性もございます。<br>
                本サイトの利用によって生じたいかなる損害についても、制作者は一切の責任を負いかねますので、あらかじめご了承ください。ご利用は自己責任でお願いいたします。
            </p>
        </div>
    </div>
    
    <div id="tsurumi-info-modal" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="tsurumi-info-modal">&times;</span>
            <h2>鶴観調整とは？</h2>
            <p>鶴観調整とは、鶴観マップの一部の精鋭エネミーの「出現パターン」を、プレイヤーが意図的にコントロールするテクニックのことです。</p>
            <p>その調整の中でも特に複雑で時間のかかる<strong>「何日にどこをロードすれば良いか」というスケジュールの計画を自動で行い、最短ルートを提案するのがこの『鶴観調整プランナー』です。</strong></p>
            
            <hr style="margin: 15px 0;">
        
            <h3>調整の基本的な仕組み</h3>
            <ul style="text-align: left; list-style: none; padding-left: 0;">
                <li style="margin-bottom: 10px;"><strong>3つの配置パターン:</strong> 調整対象のエネミーには「A」「B」「C」の3つの出現パターンがあり、それぞれ数や位置が異なります。このパターンは10箇所のエネミーグループごとに独立しています。</li>
                <li style="margin-bottom: 10px;"><strong>「ロード」による周期の進行:</strong> エネミーのパターンは、ワープや移動でそのエネミーに近づき、<strong>ゲーム内に「ロード」された時にだけ</strong>次のパターンへ1つ進みます。逆を言えば、ロードしなければパターンは変わりません。</li>
                <li style="margin-bottom: 10px;"><strong>選択的なロード:</strong> 特定の場所へワープしたり、決まったルートを移動したりすることで、一部のエネミーだけを狙ってロードし、周期を進めることができます。これが「調整」の基本となります。</li>
            </ul>
        
            <h4><strong>【重要】調整作業における注意点</strong></h4>
            <p style="text-align: left;">鶴観調整は、配置の確認から計画の実行まで、<strong>すべての工程で精密な計画と慎重な操作が求められます。</strong><br>特に、意図しないエネミーをロードしてしまうと計画が大きく崩れる可能性があります。当プランナーを利用する際も、ご自身の現在の配置を正確に入力し、算出されたスケジュールを慎重に実行してください。</p>
        
            <hr style="margin: 15px 0;">
        
            <p style="text-align: center;">鶴観の精鋭の仕組みについて、より深く、正確に知りたい方は、<br>ぜひ、ねこしたさんのこちらの解説動画をご覧ください。<br>
                <a href="https://youtu.be/2xqllaCTP5c?si=Pp_a3tTTLpFmB54B" target="_blank" rel="noopener noreferrer"><strong>【原神】鶴観の精鋭の仕組みと調整方法</strong></a>
            </p>
        </div>
    </div>

    <div id="cycle-hold-info-modal" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="cycle-hold-info-modal">&times;</span>
            <h2>周期ホールドとは？</h2>
            <p>周期ホールドとは、<strong>マルチプレイを利用して</strong>鶴観調整をより効率的に行うための<strong>高度なテクニック</strong>です。</p>
            <p><strong>このプランナーで「周期ホールドを有効化」すると、この高度なテクニックを前提とした最短の調整スケジュールを自動で算出します。</strong>ソロでの調整よりも手順は複雑になりますが、調整にかかる日数を大幅に短縮できる可能性があります。</p>
            
            <hr style="margin: 15px 0;">
        
            <h3>周期ホールドの仕組み</h3>
            <p>通常、エネミーをロードすると周期は1つ進みますが、周期ホールドを使うと<strong>「ロードしたにもかかわらず、周期を進めない」</strong>という特殊な状況を作り出せます。</p>
            <p>これにより、調整したくないエネミーの周期を「ホールド（維持）」したまま、目的のエネミーの周期だけを進める、という精密な操作が可能になります。</p>
        
            <h4>🎨 たとえ話：2人での壁塗り</h4>
            <p>このテクニックは、2人で行う壁塗りのようなものです。</p>
            <ul style="text-align: left; list-style: none; padding-left: 0;">
                <li style="margin-bottom: 5px;"><strong>壁:</strong> 鶴観の10ヶ所の精鋭グループ</li>
                <li style="margin-bottom: 5px;"><strong>1P (ホスト):</strong> 壁を青く塗る<strong>「ペイント役」</strong>。周期を進めたい人です。</li>
                <li style="margin-bottom: 5px;"><strong>2P (ゲスト/ホールド役):</strong> 壁が塗られないよう保護する<strong>「マスキングテープ役」</strong>。周期を進めたくない人です。</li>
            </ul>
            <p style="text-align: left;">ソロ調整は、ペイント役が1人で作業するのと同じです。塗ろうとした場所はすべて青くなります（周期が進みます）。<br>一方、周期ホールド（マルチ調整）では、まず2Pがマスキングテープで壁を保護します。その後、1Pが塗装をすると、最終的に青く塗られるのは<strong>「1Pが塗ろうとした範囲」から「2Pがマスキングテープで保護した範囲」を<u>除いた部分</u></strong>だけになります。</p>
            <p style="text-align: left;">このように、周期ホールドは不要な部分の周期進行を防ぐ「マスキングテープ」の役割を果たし、より正確で素早い調整を実現します。</p>
            <p style="text-align: left; margin-top: 10px;">理論上は複雑に聞こえるかもしれませんが、<strong>当プランナーで計算した後の結果画面では、各日の「手順を確認」ボタンから、ホスト役（1P）とホールド役（2P）がそれぞれ具体的にどの行動をすべきかが示されます。</strong></p>
        
            <hr style="margin: 15px 0;">
        
            <p style="text-align: center;">周期ホールドの具体的な手順や詳細な解説については、<br>ぜひ、ねこしたさんの動画をご覧ください。（該当の解説箇所から再生されます）<br>
                <a href="https://www.youtube.com/watch?v=2xqllaCTP5c&t=1194s" target="_blank" rel="noopener noreferrer"><strong>周期ホールドの解説はこちら</strong></a>
            </p>
        </div>
    </div>


    <div id="disclaimer-modal" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="disclaimer-modal">&times;</span>
            <h2>注意事項</h2>
            
            <hr style="margin: 10px 0;">

            <h4>正確性とリスクについて</h4>
            <p style="text-align: left; line-height: 1.7; font-size: 0.9em;">
                このプランナーは、制作者が個人的に制作した非公式のファンツールです。<br>
                計算結果の正確性には万全を期しておりますが、ゲームのアップデート等により情報が古くなる可能性や、予期せぬ不具合が発生する可能性もございます。<br>
                また、配置を誤って入力した場合、当然ながら正しくない調整スケジュールが出力されます。入力内容が正しいか、十分にご確認ください。
            </p>

            <h4 style="margin-top: 20px;">免責事項</h4>
            <p style="text-align: left; line-height: 1.7; font-size: 0.9em;">
                本サイトを利用したことで生じたいかなる損害についても、制作者は一切の責任を負いかねます。<br>
                すべての操作は、自己責任の上で慎重に行っていただきますよう、お願いいたします。
            </p>
        </div>
    </div>
    
    <div id="zoom-view" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="zoom-view">&times;</span>
            <h3 id="zoom-title"></h3>
            <div id="zoom-map-container" class="image-container">
                <div class="image-loader">読み込み中...</div>
                <img src="https://placehold.co/800x500/e9e9e9/333?text=Zoomed+Area" alt="ズームマップ">
            </div>
        </div>
    </div>

    <div id="screenshot-popup" class="modal backdrop-blur">
        <div class="modal-content">
             <span class="modal-close" data-target="screenshot-popup">&times;</span>
             <h3 id="screenshot-title"></h3>
             <div class="image-container">
                <div class="image-loader">読み込み中...</div>
                <img id="screenshot-img" src="https://placehold.co/500x300/eef2ff/312e81?text=In-Game+Screenshot" alt="ゲーム内スクリーンショット">
             </div>
             <button id="confirm-pattern-btn" class="btn btn-primary" style="margin-top: 15px;">確定</button>
        </div>
    </div>
    
    <div id="loading-modal" class="modal">
         <div class="modal-content" style="text-align: center;">
            <h2 style="font-size: 2.5em; margin-bottom: 10px;">計算中...</h2>
            <p id="loading-text">最適なルートを探索しています。<br>組み合わせが複雑な場合、十数秒かかることがあります。</p>
            <div class="loader"></div>
            <div id="calculation-progress"></div>
         </div>
    </div>
    
    <div id="day-detail-modal" class="modal backdrop-blur">
         <div class="modal-content">
              <span class="modal-close" data-target="day-detail-modal">&times;</span>
              <h2 id="day-detail-title"></h2>
              <div id="day-detail-content"></div>
       </div>
    </div>

    <div id="credit-modal" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="credit-modal">&times;</span>
            <h2>Special Thanks</h2>
            <p>このツールの開発にあたり、「ねこした」さんより多大なるご協力をいただきました。<br>心より感謝申し上げます。</p>
            
            <hr style="margin: 20px 0;">
            
            <h4>■ 画像・情報提供</h4>
            <p>ツール内で使用している各配置の画像や、精鋭エネミーの出現パターンに関する情報は、以下のnote記事を参考にさせていただきました。非常に分かりやすくまとめられており、開発の大きな助けとなりました。</p>
            <p style="padding-left: 1em;"><strong>note記事:</strong> <a href="https://note.com/nekoshita_g/n/nba4aff6a13ff" target="_blank" rel="noopener noreferrer">【原神】鶴観の精鋭の仕組みと調整方法</a></p>
            
            <h4>■ 調整方法の解説</h4>
            <p>本ツールの計算ロジックは、以下の動画で解説されている調整方法を基にプログラムとして実装したものです。鶴観調整の仕組みそのものについて、大変分かりやすく解説されていますので、ぜひご覧ください。</p>
            <p style="padding-left: 1em;"><strong>解説動画:</strong> <a href="https://youtu.be/2xqllaCTP5c?si=jY3Vn64mj6y91Vte" target="_blank" rel="noopener noreferrer">【原神】鶴観の精鋭の仕組みと調整方法 (YouTube)</a></p>
            
            <hr style="margin: 20px 0;">
            
            <p style="text-align: center;">
                <a href="https://www.youtube.com/@nekoshita_g" target="_blank" rel="noopener noreferrer" class="btn btn-secondary" style="text-decoration: none;">ねこしたさんのYouTubeチャンネルはこちら</a>
            </p>
        </div>
    </div>
    
    <div id="load-plan-modal" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="load-plan-modal">&times;</span>
            <h2>保存したプランを読み込む</h2>
            <ul id="saved-plans-list">
                <!-- Saved plans will be dynamically inserted here -->
            </ul>
            <p id="no-saved-plans">保存されたプランはありません。</p>
        </div>
    </div>

    <!-- New Logic Modal -->
    <div id="logic-modal" class="modal backdrop-blur">
        <div class="modal-content">
            <span class="modal-close" data-target="logic-modal">&times;</span>
            <h2>製作者と計算の仕組みについて</h2>

            <h3>製作者について</h3>
            <p>はじめまして、「あの時の鳥です」と申します。この「鶴観調整プランナー」を制作・運営しています。</p>
            <p>精鋭狩りRTAに挑戦する中で、多くの人が直面する「鶴観調整」という高い壁を少しでも低くしたい。そして、この界隈に挑戦する仲間が一人でも増えてくれたら嬉しい。そんな想いで、このツールを丹精込めて制作しました。</p>
            <p>本サイトの改善案や追加機能のご要望などありましたら、お気軽に相談していただけると幸いです。<br><a href="https://x.com/PIpXlMz1tB5ASjF" target="_blank" rel="noopener noreferrer"><strong>X (旧Twitter) アカウントはこちら</strong></a></p>
            
            <hr style="margin: 25px 0;">

            <h3>計算ロジックの正しさと「最短」であることの証明</h3>
            <p>このプランナーが提示するスケジュールは、なぜ<strong>正しく</strong>、かつ<strong>「最短」</strong>であると保証できるのでしょうか？<br>
            それは、当てずっぽうや魔法のような方法ではなく、<strong>ゲーム内の確定的なルール</strong>を土台とし、それを<strong>正確な数式モデル</strong>へ変換、その上で<strong>数学的に証明されたアルゴリズム</strong>を用いて解を探索しているからです。</p>

            <h4 style="margin-top:20px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px;">Step 1: 前提となる「ゲームのルール」</h4>
            <p style="text-align: left;">まず、大前提として、プランナーは以下の<strong>ゲーム内の確定的な法則</strong>に基づいて計算を行っています。</p>
            <ul style="text-align: left; list-style: none; padding-left: 1em;">
                <li style="margin-bottom: 10px; padding-left: 1.5em; position: relative;"><span style="position: absolute; left: 0; color: var(--accent-color);">✓</span><strong>ルール1：</strong>調整対象の精鋭は10グループあり、各グループは必ず「A, B, C」の3パターンのいずれかの状態になります。</li>
                <li style="margin-bottom: 10px; padding-left: 1.5em; position: relative;"><span style="position: absolute; left: 0; color: var(--accent-color);">✓</span><strong>ルール2：</strong>パターンは、プレイヤーがその場に近づき「ロード」するという行為によってのみ、A→B→C→A と1つずつ進みます。</li>
                <li style="margin-bottom: 10px; padding-left: 1.5em; position: relative;"><span style="position: absolute; left: 0; color: var(--accent-color);">✓</span><strong>ルール3：</strong>どの行動（ワープや移動）が、どのグループをロードするかは、先人たちの膨大な検証によってデータ化されています。（当サイトもそのデータを基にしています）</li>
            </ul>
            <p style="text-align: left;">プランナーは、これらの不変のルールとデータをパズルのピースとして利用します。</p>

            <h4 style="margin-top:20px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px;">Step 2: ルールを「数式モデル」に変換する (正しさの証明)</h4>
            <p style="text-align: left;">次に、このルールをコンピュータが計算できる「数式モデル」に置き換えます。</p>
            <ul style="text-align: left; list-style: none; padding-left: 1em;">
                <li style="margin-bottom: 10px; padding-left: 1.5em; position: relative;"><span style="position: absolute; left: 0; color: var(--accent-color);">✓</span><strong>ルールの数値化:</strong> 鶴観の10個の精鋭グループがそれぞれ3パターンの状態を持つということは、3の10乗、すなわち<strong>59,049通り</strong>もの膨大な配置パターンが存在することを意味します。プランナーは、この59,049通りの全パターンを、それぞれ重複しないユニークな番号（状態番号）に変換します。</li>
                <li style="margin-bottom: 10px; padding-left: 1.5em; position: relative;"><span style="position: absolute; left: 0; color: var(--accent-color);">✓</span>「ワープ②」や「歩き⑬」といった各調整アクションは、「<strong>ある状態番号</strong>を受け取ったら、ルール（`data.js`）に従って影響範囲のパターンを1つ進め、<strong>別の状態番号</strong>を返す関数」としてモデル化されます。</li>
            </ul>
            <p style="text-align: left;"><strong>結論:</strong> ゲーム内で起こりうる<strong>全ての配置パターン</strong>と、プレイヤーが取りうる<strong>全ての調整アクション</strong>を、このように漏れなく数値と数式の関係に変換することで、プランナーはゲーム内の鶴観調整をPC上で<strong>完全にシミュレート</strong>することが可能になります。これにより、計算ロジックが<strong>ゲームのルール通りに正しく機能する</strong>ことが保証されます。</p>

            <h4 style="margin-top:20px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px;">Step 3: どうやって最短ルートを探しているのか？</h4>
            <p style="text-align: left;">ルール通りに動くシミュレーターが完成したら、次はその中から最短ルートを探します。この探し方は、駅の「最短乗り換え案内」のロジックと非常によく似ています。</p>
            <div style="background-color: #f3f4f6; border-left: 4px solid #d1d5db; padding: 15px; margin: 15px 0; border-radius: 4px;">
                <p><strong>たとえ話：最短乗り換え案内</strong></p>
                <ul style="padding-left: 2em; list-style: disc;">
                    <li><strong>あなたの現在地:</strong> 現在の配置の「状態番号」</li>
                    <li><strong>目的地:</strong> あなたが設定した理想の配置の「状態番号」</li>
                    <li><strong>電車での1回の移動:</strong> 1日分の調整作業（状態番号の変化）</li>
                </ul>
            </div>
            <p style="text-align: left;">目的地までの最短ルートを探すため、プランナーは以下のような手順で、可能性のあるルートを<strong>しらみつぶしに</strong>探索します。</p>
            <ol style="text-align: left; padding-left: 2em;">
                <li style="margin-bottom: 5px;">まず、「現在地」から<strong>1回の移動（1日）</strong>で行ける全ての「次の駅（次の日の状態番号）」をリストアップします。</li>
                <li style="margin-bottom: 5px;">次に、リストアップした全ての駅から、さらに<strong>1回の移動（合計2日）</strong>で行ける全ての駅をリストアップします。</li>
                <li style="margin-bottom: 5px;">これを、「目的地」の状態番号に到着するまで繰り返します。</li>
            </ol>
            <img src="https://github.com/Anotokinotori/Tsurumi-Route-Optimizer/blob/main/logic-bfs.png?raw=true" alt="ルート探索のイメージ図" style="width:100%; max-width: 500px; border-radius: 8px; margin-top: 10px; display: block; margin-left: auto; margin-right: auto;">

            <h4 style="margin-top:20px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px;">Step 4: なぜそれが「最短」だと証明できるのか</h4>
            <p style="text-align: left;">この「しらみつぶし」の探し方には、重要な特徴があります。</p>
            <p style="text-align: left;">それは、<strong>1日で行けるルートを全て探し尽くしてから、初めて2日で行けるルートを探し始める</strong>、という点です。</p>
            <p style="text-align: left;">このため、「目的地」に<strong>最初に到着した時点で、それが最も日数が少ない（乗り換えが少ない）ルートである</strong>ことが論理的に保証されます。もし3日で着くルートが見つかった後に、実は2日で着く隠れたルートが見つかる、ということは絶対に起こりません。</p>
            <p style="text-align: left;">この方法は、コンピュータ科学の世界では「<strong>幅優先探索（BFS）</strong>」と呼ばれるアルゴリズムで、最短経路問題の解法として数学的に確立された、非常にポピュラーなものです。当プランナーは、この信頼性の高いアルゴリズムを採用することで、常に最適な解を導き出しています。</p>

        </div>
    </div>


    <footer class="site-credit-footer backdrop-blur">
        <p>
            <span id="credit-modal-trigger">Special Thanks: ねこしたさん (詳細はこちら)</span>
            <span class="credit-separator">|</span>
            <span>鶴観を研究してくださった先人の方々</span>
        </p>
    </footer>

    <!-- JavaScriptファイルを外部から読み込み -->
    <!-- データ定義を先に、メインロジックを後に読み込む -->
    <script src="js/data.js"></script>
    <script src="js/main.js"></script>
</body>
</html>

